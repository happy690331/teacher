<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¥å¥‡ä¸‰è§’å½¢å†’éšªï¼šå››ä¸Šæ•¸å­¸</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        body { 
            touch-action: manipulation; 
            font-family: 'Noto Sans TC', sans-serif;
            -webkit-user-select: none;
            user-select: none;
        }
        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
        .perspective { perspective: 1000px; }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .animate-float { animation: float 3s infinite ease-in-out; }
    </style>
</head>
<body class="bg-sky-50 text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- å­çµ„ä»¶ï¼šä¸‰è§’å½¢ç¹ªè£½ ---
        const TriangleSVG = ({ type = "isosceles", color = "#3b82f6", size = 120, highlightPart = null }) => {
            const points = {
                equilateral: "60,10 10,110 110,110",
                isosceles: "60,10 30,110 90,110",
                right: "10,10 10,110 110,110",
                obtuse: "10,110 60,80 110,110",
                acute: "60,10 20,90 100,90"
            };

            return (
                <svg width={size} height={size} viewBox="0 0 120 120" className="drop-shadow-md">
                    <polygon 
                        points={points[type] || points.equilateral} 
                        fill={color} 
                        stroke="#1e293b" 
                        strokeWidth="3" 
                        strokeLinejoin="round"
                    />
                    {/* é ‚é»æ¨™è¨˜ */}
                    {highlightPart === 'vertex' && (
                        <g>
                            <circle cx="60" cy="10" r="5" fill="#ef4444" />
                            <circle cx="10" cy="110" r="5" fill="#ef4444" />
                            <circle cx="110" cy="110" r="5" fill="#ef4444" />
                        </g>
                    )}
                </svg>
            );
        };

        const App = () => {
            const [tab, setTab] = useState('learn');
            const [score, setScore] = useState(0);

            // å°èˆªæŒ‰éˆ•
            const NavBtn = ({ id, icon, label }) => (
                <button 
                    onClick={() => setTab(id)}
                    className={`flex flex-col items-center p-2 rounded-xl transition-all ${tab === id ? 'text-blue-600 bg-blue-100' : 'text-slate-400'}`}
                >
                    <i className={`lucide-${icon} w-6 h-6 mb-1`}></i>
                    <span className="text-xs font-bold">{label}</span>
                </button>
            );

            return (
                <div className="flex flex-col h-screen max-w-md mx-auto bg-white shadow-xl overflow-hidden">
                    {/* Header */}
                    <header className="p-4 bg-white border-b flex justify-between items-center z-10">
                        <div className="flex items-center gap-2">
                            <div className="bg-blue-500 p-2 rounded-lg text-white">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 21 9-18 9 18H3z"/></svg>
                            </div>
                            <h1 className="font-bold text-lg text-slate-700">ä¸‰è§’å½¢å†’éšª</h1>
                        </div>
                        <div className="bg-yellow-100 px-3 py-1 rounded-full border border-yellow-300 flex items-center">
                            <span className="text-yellow-600 font-bold mr-1">â­</span>
                            <span className="font-bold text-yellow-700">{score}</span>
                        </div>
                    </header>

                    {/* Content */}
                    <main className="flex-1 overflow-y-auto p-4 bg-slate-50">
                        {tab === 'learn' && <LearnSection onNext={() => setTab('unit1')} />}
                        {tab === 'unit1' && <UnitOneGame setScore={setScore} onNext={() => setTab('unit2')} />}
                        {tab === 'unit2' && <UnitTwoGame setScore={setScore} onNext={() => setTab('unit3')} />}
                        {tab === 'unit3' && <UnitThreeGame setScore={setScore} onNext={() => setTab('quiz')} />}
                        {tab === 'quiz' && <FinalQuiz score={score} onReset={() => {setScore(0); setTab('learn');}} />}
                    </main>

                    {/* Footer Nav */}
                    <nav className="p-2 bg-white border-t flex justify-around items-center pb-safe">
                        <NavBtn id="learn" icon="book-open" label="å­¸ç¿’" />
                        <NavBtn id="unit1" icon="search" label="æ‰¾é ‚é»" />
                        <NavBtn id="unit2" icon="layers" label="åˆ†åˆ†é¡" />
                        <NavBtn id="unit3" icon="copy" label="ä¸€æ¨¡ä¸€æ¨£" />
                    </nav>
                </div>
            );
        };

        // --- å­¸ç¿’å–®å…ƒ ---
        const LearnSection = ({ onNext }) => (
            <div className="space-y-4 animate-in fade-in slide-in-from-bottom-4">
                <div className="rounded-2xl overflow-hidden shadow-md bg-white">
                    <div className="aspect-video bg-slate-200 flex items-center justify-center">
                        <iframe 
                            width="100%" height="100%" 
                            src="https://www.youtube.com/embed/zR3R7-m3D-Y" 
                            title="ä¸‰è§’å½¢æ•™å­¸" frameBorder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowFullScreen
                        ></iframe>
                    </div>
                    <div className="p-4">
                        <h3 className="font-bold text-lg">ä»Šå¤©æˆ‘å€‘è¦å­¸ä»€éº¼ï¼Ÿ</h3>
                        <p className="text-slate-500 text-sm">ä¸‰è§’å½¢çš„é ‚é»ã€é‚Šï¼Œé‚„æœ‰å…¨ç­‰åœ–å½¢å–”ï¼</p>
                    </div>
                </div>

                <div className="bg-blue-50 p-4 rounded-2xl border-2 border-blue-100 flex items-center gap-4">
                    <div className="w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center text-2xl">ğŸ“</div>
                    <div>
                        <p className="font-bold text-blue-700">è¨˜ä½å…¬å¼</p>
                        <p className="text-slate-600 text-sm">ä¸‰è§’å½¢æœ‰ <span className="text-blue-600 font-bold underline">3å€‹é ‚é»</span> å’Œ <span className="text-blue-600 font-bold underline">3æ¢é‚Š</span>ã€‚</p>
                    </div>
                </div>

                <button onClick={onNext} className="w-full py-4 bg-blue-500 text-white rounded-2xl font-bold shadow-lg shadow-blue-200 active:scale-95 transition-all">
                    æº–å‚™å¥½äº†ï¼Œé–‹å§‹é—–é—œï¼
                </button>
            </div>
        );

        // --- å–®å…ƒä¸€ï¼šèªè­˜ä¸‰è§’å½¢çµ„æˆ (6é¡Œ) ---
        const UnitOneGame = ({ setScore, onNext }) => {
            const [qIdx, setQIdx] = useState(0);
            const [feedback, setFeedback] = useState(null);

            const questions = [
                { q: "ä¸‰è§’å½¢æœ‰å¹¾å€‹é ‚é»ï¼Ÿ", options: ["2å€‹", "3å€‹", "4å€‹"], ans: 1 },
                { q: "ä¸‰è§’å½¢æœ‰å¹¾æ¢é‚Šï¼Ÿ", options: ["3æ¢", "5æ¢", "4æ¢"], ans: 0 },
                { q: "ä¸‰è§’å½¢è£¡é¢æœ‰å¹¾å€‹è§’ï¼Ÿ", options: ["1å€‹", "2å€‹", "3å€‹"], ans: 2 },
                { q: "å°–å°–çš„åœ°æ–¹æˆ‘å€‘å«åšï¼Ÿ", options: ["é ‚é»", "é•·é‚Š", "ç›´ç·š"], ans: 0 },
                { q: "é€™æ˜¯ä¸€å€‹ä¸‰è§’å½¢å—ï¼Ÿ(æœ‰3æ¢é‚Š)", options: ["æ˜¯", "ä¸æ˜¯"], ans: 0 },
                { q: "æ­£æ–¹å½¢æ¯”ä¸‰è§’å½¢å¤šå¹¾æ¢é‚Šï¼Ÿ", options: ["1æ¢", "2æ¢", "3æ¢"], ans: 0 }
            ];

            const handleAns = (i) => {
                if (feedback) return;
                if (i === questions[qIdx].ans) {
                    setFeedback('correct');
                    setScore(s => s + 10);
                } else {
                    setFeedback('wrong');
                }
                setTimeout(() => {
                    if (qIdx < questions.length - 1) {
                        setQIdx(qIdx + 1);
                        setFeedback(null);
                    } else {
                        onNext();
                    }
                }, 1000);
            };

            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center text-xs font-bold text-slate-400">
                        <span>å–®å…ƒï¼šæ‰¾æ‰¾çœ‹</span>
                        <span>{qIdx + 1} / 6</span>
                    </div>
                    <div className="bg-white p-6 rounded-3xl shadow-sm border-2 border-slate-100 flex flex-col items-center">
                        <div className="mb-4"><TriangleSVG highlightPart={qIdx === 0 ? 'vertex' : null} /></div>
                        <h2 className="text-xl font-bold text-slate-700 text-center">{questions[qIdx].q}</h2>
                    </div>
                    <div className="grid gap-3">
                        {questions[qIdx].options.map((opt, i) => (
                            <button 
                                key={i} onClick={() => handleAns(i)}
                                className={`py-4 rounded-2xl font-bold text-lg border-2 transition-all ${feedback === 'correct' && i === questions[qIdx].ans ? 'bg-green-100 border-green-500 text-green-700' : feedback === 'wrong' && i === questions[qIdx].ans ? 'bg-blue-50 border-blue-500' : 'bg-white border-slate-200'}`}
                            >
                                {opt}
                            </button>
                        ))}
                    </div>
                </div>
            );
        };

        // --- å–®å…ƒäºŒï¼šä¸‰è§’å½¢åˆ†é¡ (6é¡Œ) ---
        const UnitTwoGame = ({ setScore, onNext }) => {
            const [qIdx, setQIdx] = useState(0);
            const [feedback, setFeedback] = useState(null);

            const questions = [
                { q: "æœ‰å…©æ¢é‚Šä¸€æ¨£é•·ï¼Œå«åšä»€éº¼ä¸‰è§’å½¢ï¼Ÿ", type: "isosceles", options: ["ç­‰è…°ä¸‰è§’å½¢", "æ­£ä¸‰è§’å½¢"], ans: 0 },
                { q: "ä¸‰æ¢é‚Šéƒ½ä¸€æ¨£é•·ï¼Œå«åšä»€éº¼ä¸‰è§’å½¢ï¼Ÿ", type: "equilateral", options: ["ç­‰è…°ä¸‰è§’å½¢", "æ­£ä¸‰è§’å½¢"], ans: 1 },
                { q: "æœ‰ä¸€å€‹è§’æ˜¯ âˆŸ (ç›´è§’) çš„æ˜¯ï¼Ÿ", type: "right", options: ["éˆè§’ä¸‰è§’å½¢", "ç›´è§’ä¸‰è§’å½¢"], ans: 1 },
                { q: "ä¸‰å€‹è§’éƒ½å°–å°–çš„(å°æ–¼90åº¦)æ˜¯ï¼Ÿ", type: "acute", options: ["éŠ³è§’ä¸‰è§’å½¢", "éˆè§’ä¸‰è§’å½¢"], ans: 0 },
                { q: "æœ‰ä¸€å€‹è§’å¤§å¤§çš„(å¤§æ–¼90åº¦)æ˜¯ï¼Ÿ", type: "obtuse", options: ["éˆè§’ä¸‰è§’å½¢", "éŠ³è§’ä¸‰è§’å½¢"], ans: 0 },
                { q: "æ­£ä¸‰è§’å½¢ä¹Ÿæ˜¯ä¸€ç¨®ç­‰è…°ä¸‰è§’å½¢å—ï¼Ÿ", type: "equilateral", options: ["æ˜¯ï¼Œå› ç‚ºå®ƒä¹Ÿæœ‰å…©é‚Šä¸€æ¨£", "ä¸æ˜¯"], ans: 0 }
            ];

            const handleAns = (i) => {
                if (feedback) return;
                if (i === questions[qIdx].ans) {
                    setFeedback('correct');
                    setScore(s => s + 15);
                } else {
                    setFeedback('wrong');
                }
                setTimeout(() => {
                    if (qIdx < questions.length - 1) {
                        setQIdx(qIdx + 1);
                        setFeedback(null);
                    } else {
                        onNext();
                    }
                }, 1000);
            };

            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center text-xs font-bold text-slate-400">
                        <span>å–®å…ƒï¼šåˆ†åˆ†é¡</span>
                        <span>{qIdx + 1} / 6</span>
                    </div>
                    <div className="bg-white p-6 rounded-3xl shadow-sm border-2 border-slate-100 flex flex-col items-center">
                        <div className="mb-4"><TriangleSVG type={questions[qIdx].type} color="#10b981" /></div>
                        <h2 className="text-xl font-bold text-slate-700 text-center">{questions[qIdx].q}</h2>
                    </div>
                    <div className="grid gap-3">
                        {questions[qIdx].options.map((opt, i) => (
                            <button key={i} onClick={() => handleAns(i)} className="py-4 bg-white rounded-2xl font-bold text-lg border-2 border-slate-200 active:border-blue-500 transition-all">
                                {opt}
                            </button>
                        ))}
                    </div>
                </div>
            );
        };

        // --- å–®å…ƒä¸‰ï¼šå…¨ç­‰åœ–å½¢ (6é¡Œ) ---
        const UnitThreeGame = ({ setScore, onNext }) => {
            const [qIdx, setQIdx] = useState(0);
            const [feedback, setFeedback] = useState(null);

            const questions = [
                { q: "ä»€éº¼æ˜¯ã€Œå…¨ç­‰ã€ä¸‰è§’å½¢ï¼Ÿ", options: ["å½¢ç‹€ä¸€æ¨£ï¼Œå¤§å°ä¸ä¸€æ¨£", "å½¢ç‹€ã€å¤§å°å®Œå…¨ä¸€æ¨£"], ans: 1 },
                { q: "å…¨ç­‰ä¸‰è§’å½¢ç–Šåœ¨ä¸€èµ·æœƒï¼Ÿ", options: ["å®Œå…¨ç–Šåˆ", "ç–Šä¸èµ·ä¾†"], ans: 0 },
                { q: "ç–Šåœ¨ä¸€èµ·æ™‚ï¼Œå°åˆ°çš„é»å«ä»€éº¼ï¼Ÿ", options: ["å°æ‡‰é‚Š", "å°æ‡‰é ‚é»"], ans: 1 },
                { q: "ç–Šåœ¨ä¸€èµ·æ™‚ï¼Œå°åˆ°çš„é‚Šå«ä»€éº¼ï¼Ÿ", options: ["å°æ‡‰é‚Š", "å°æ‡‰è§’"], ans: 0 },
                { q: "å…¨ç­‰åœ–å½¢çš„å°æ‡‰è§’å¤§å°æœƒï¼Ÿ", options: ["ä¸€æ¨£å¤§", "ä¸ä¸€æ¨£å¤§"], ans: 0 },
                { q: "å…¨ç­‰åœ–å½¢çš„å°æ‡‰é‚Šé•·åº¦æœƒï¼Ÿ", options: ["ä¸ä¸€æ¨£é•·", "ä¸€æ¨£é•·"], ans: 1 }
            ];

            const handleAns = (i) => {
                if (feedback) return;
                if (i === questions[qIdx].ans) {
                    setFeedback('correct');
                    setScore(s => s + 20);
                } else {
                    setFeedback('wrong');
                }
                setTimeout(() => {
                    if (qIdx < questions.length - 1) {
                        setQIdx(qIdx + 1);
                        setFeedback(null);
                    } else {
                        onNext();
                    }
                }, 1000);
            };

            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center text-xs font-bold text-slate-400">
                        <span>å–®å…ƒï¼šä¸€æ¨¡ä¸€æ¨£</span>
                        <span>{qIdx + 1} / 6</span>
                    </div>
                    <div className="bg-white p-6 rounded-3xl shadow-sm border-2 border-slate-100 flex flex-col items-center">
                        <div className="flex gap-4 mb-4">
                            <TriangleSVG type="right" color="#f59e0b" size={80} />
                            <TriangleSVG type="right" color="#f59e0b" size={80} />
                        </div>
                        <h2 className="text-xl font-bold text-slate-700 text-center">{questions[qIdx].q}</h2>
                    </div>
                    <div className="grid gap-3">
                        {questions[qIdx].options.map((opt, i) => (
                            <button key={i} onClick={() => handleAns(i)} className="py-4 bg-white rounded-2xl font-bold text-lg border-2 border-slate-200 transition-all">
                                {opt}
                            </button>
                        ))}
                    </div>
                </div>
            );
        };

        // --- çµç®—ç•«é¢ ---
        const FinalQuiz = ({ score, onReset }) => (
            <div className="text-center py-10 space-y-6 animate-in zoom-in">
                <div className="text-8xl mb-4 animate-float">ğŸ†</div>
                <h2 className="text-3xl font-bold text-slate-800">é—–é—œæˆåŠŸï¼</h2>
                <div className="bg-white p-6 rounded-3xl shadow-lg border-2 border-yellow-200">
                    <p className="text-slate-500 uppercase tracking-widest text-sm mb-2">ä½ çš„ç¸½åˆ†</p>
                    <p className="text-6xl font-black text-blue-600">{score}</p>
                    <p className="mt-4 text-slate-600 font-medium">ä½ æ˜¯ä¸‰è§’å½¢å°å°ˆå®¶å–”ï¼</p>
                </div>
                <button 
                    onClick={onReset}
                    className="w-full py-4 bg-slate-800 text-white rounded-2xl font-bold text-lg flex items-center justify-center gap-2"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
                    å†ç©ä¸€æ¬¡
                </button>
            </div>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>