<!doctype html>
<html lang="zh-TW">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åº·è»’åœ‹èªå…­ä¸Šèªè©æ´å¯Ÿå…ˆæ©Ÿ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            box-sizing: border-box;
        }

        /* é€šç”¨å®¹å™¨æ¨£å¼ */
        .card-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 900px; /* ç¨å¾®åŠ å¯¬å®¹å™¨ä»¥é©æ‡‰è®Šå¤§çš„å¡ç‰‡ */
            width: 100%;
            transition: all 0.3s ease;
        }

        /* æ¨™é¡Œæ¨£å¼ */
        .main-title {
            font-size: 2rem;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.4;
        }

        /* --- é¸å–®å±¤æ¨£å¼ --- */
        .lesson-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .lesson-toggle {
            background: #edf2f7;
            border: 2px solid #cbd5e0;
            border-radius: 15px;
            padding: 15px 10px;
            font-size: 1.1rem;
            font-weight: bold;
            color: #4a5568;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .lesson-title-small {
            font-size: 0.9rem;
            font-weight: normal;
            opacity: 0.9;
        }

        .lesson-toggle:hover {
            transform: translateY(-2px);
            background: #e2e8f0;
        }

        .lesson-toggle.selected {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .start-btn {
            background: linear-gradient(45deg, #48bb78, #38a169);
            color: white;
            font-size: 1.5rem;
            padding: 15px 50px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(72, 187, 120, 0.4);
            transition: all 0.3s ease;
        }

        .start-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(72, 187, 120, 0.6);
        }
        
        .start-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* --- éŠæˆ²å±¤æ¨£å¼ --- */
        
        /* è³‡è¨Šåˆ—èˆ‡æ‹‰éœ¸æ©Ÿå®¹å™¨ */
        .info-bar {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .progress-info {
            font-size: 1.2rem;
            color: #4a5568;
            padding: 10px 20px;
            background: linear-gradient(45deg, #f7fafc, #edf2f7);
            border-radius: 15px;
            border: 2px solid #e2e8f0;
            display: flex;
            align-items: center;
            height: 50px; /* å›ºå®šé«˜åº¦ä»¥å°é½Š */
            box-sizing: border-box;
        }

        /* æ‹‰éœ¸æ©ŸæŒ‰éˆ•æ¨£å¼ */
        .slot-machine {
            background: linear-gradient(45deg, #f6e05e, #ecc94b);
            border: 3px solid #d69e2e;
            border-radius: 15px;
            padding: 0 20px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #744210;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.2s;
            min-width: 140px;
            height: 50px; /* å›ºå®šé«˜åº¦ä»¥å°é½Š */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slot-machine:hover {
            transform: translateY(-2px);
            background: linear-gradient(45deg, #faf089, #f6e05e);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .slot-machine:active {
            transform: translateY(1px);
        }

        .slot-machine.disabled {
            opacity: 0.6;
            cursor: not-allowed;
            filter: grayscale(1);
            background: #cbd5e0;
            border-color: #a0aec0;
            color: #4a5568;
            transform: none !important;
        }

        /* ä¸»è¦ä¿®æ”¹å€åŸŸï¼šæ”¾å¤§å°ºå¯¸ */
        .word-card {
            position: relative;
            width: 600px; 
            height: 300px;
            background: linear-gradient(45deg, #f7fafc, #edf2f7);
            border-radius: 20px; 
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            border: 4px solid #e2e8f0; 
            overflow: hidden;
            margin: 0 auto 30px;
        }

        /* æ•¸å­—åœˆåœˆæ¨£å¼ - æ”¾å¤§ */
        .number-circle {
            position: absolute;
            border-radius: 50%;
            background: #ffffff;
            border: 4px solid #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #2d3748;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 3;
            width: 100px;
            height: 100px;
            font-size: 2.5rem; 
        }
        
        .number-circle.pos-1 { top: 32.5%; left: 12.5%; transform: translate(-50%, -50%); }
        .number-circle.pos-2 { top: 25%; left: 30.75%; transform: translate(-50%, -50%); }
        .number-circle.pos-3 { top: 32.5%; left: 48.5%; transform: translate(-50%, -50%); }
        .number-circle.pos-4 { top: 25%; left: 66.75%; transform: translate(-50%, -50%); }
        .number-circle.pos-5 { top: 32.5%; left: 86.5%; transform: translate(-50%, -50%); }
        .number-circle.pos-6 { top: 75%; left: 12.5%; transform: translate(-50%, -50%); }
        .number-circle.pos-7 { top: 62.5%; left: 30.75%; transform: translate(-50%, -50%); }
        .number-circle.pos-8 { top: 75%; left: 48.5%; transform: translate(-50%, -50%); }
        .number-circle.pos-9 { top: 62.5%; left: 66.75%; transform: translate(-50%, -50%); }
        .number-circle.pos-10 { top: 75%; left: 86.5%; transform: translate(-50%, -50%); }

        .number-circle:hover {
            transform: translate(-50%, -50%) scale(1.1);
            background: #ffffff;
            box-shadow: 0 6px 16px rgba(0,0,0,0.3);
        }

        .number-circle.hidden {
            opacity: 0;
            pointer-events: none;
            transform: translate(-50%, -50%) scale(0);
        }

        /* é®ç½©å¡ç‰‡æ¨£å¼ - æ´å£æ”¾å¤§ */
        .cover-card {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            z-index: 2;
             -webkit-mask-image: 
                radial-gradient(circle at 12.5% 32.5%, transparent 45px, black 48px),
                radial-gradient(circle at 30.75% 25%, transparent 45px, black 48px),
                radial-gradient(circle at 48.5% 32.5%, transparent 45px, black 48px),
                radial-gradient(circle at 66.75% 25%, transparent 45px, black 48px),
                radial-gradient(circle at 86.5% 32.5%, transparent 45px, black 48px),
                radial-gradient(circle at 12.5% 75%, transparent 45px, black 48px),
                radial-gradient(circle at 30.75% 62.5%, transparent 45px, black 48px),
                radial-gradient(circle at 48.5% 75%, transparent 45px, black 48px),
                radial-gradient(circle at 66.75% 62.5%, transparent 45px, black 48px),
                radial-gradient(circle at 86.5% 75%, transparent 45px, black 48px);
            -webkit-mask-composite: intersect;
            mask-image: 
                radial-gradient(circle at 12.5% 32.5%, transparent 45px, black 48px),
                radial-gradient(circle at 30.75% 25%, transparent 45px, black 48px),
                radial-gradient(circle at 48.5% 32.5%, transparent 45px, black 48px),
                radial-gradient(circle at 66.75% 25%, transparent 45px, black 48px),
                radial-gradient(circle at 86.5% 32.5%, transparent 45px, black 48px),
                radial-gradient(circle at 12.5% 75%, transparent 45px, black 48px),
                radial-gradient(circle at 30.75% 62.5%, transparent 45px, black 48px),
                radial-gradient(circle at 48.5% 75%, transparent 45px, black 48px),
                radial-gradient(circle at 66.75% 62.5%, transparent 45px, black 48px),
                radial-gradient(circle at 86.5% 75%, transparent 45px, black 48px);
            mask-composite: intersect;
            cursor: pointer;
            transition: opacity 0.5s ease;
        }

        .cover-card.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* èªè©å­—é«”æ”¾å¤§ */
        .word {
            font-size: 15rem;
            font-weight: normal;
            color: #2d3748;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            font-family: 'DFKai-SB', 'æ¨™æ¥·é«”', 'BiauKai', serif;
            transition: opacity 0.3s ease;
        }

        .word.long-word {
            font-size: 10rem;
        }

        .game-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .btn {
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .restart-btn { background: linear-gradient(45deg, #667eea, #764ba2); color: white; }
        .next-btn { background: linear-gradient(45deg, #48bb78, #38a169); color: white; }
        .prev-btn { background: linear-gradient(45deg, #ed8936, #dd6b20); color: white; }
        
        .back-menu-btn {
            background: transparent;
            border: 2px solid #a0aec0;
            color: #718096;
            margin-top: 20px;
        }
        
        .back-menu-btn:hover {
            background: #edf2f7;
            color: #4a5568;
            transform: translateY(-2px);
        }

        .btn:hover { transform: translateY(-2px); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none !important; }

        .hidden-screen {
            display: none !important;
        }

        /* æ‰‹æ©Ÿç‰ˆé©é… */
        @media (max-width: 640px) {
            .word-card { width: 320px; height: 160px; }
            .number-circle { width: 50px; height: 50px; font-size: 1.2rem; border-width: 2px; }
            /* æ‰‹æ©Ÿç‰ˆé®ç½©æ´å£é‚„åŸå°å°ºå¯¸ */
            .cover-card {
                -webkit-mask-image: 
                radial-gradient(circle at 12.5% 32.5%, transparent 22px, black 24px),
                radial-gradient(circle at 30.75% 25%, transparent 22px, black 24px),
                radial-gradient(circle at 48.5% 32.5%, transparent 22px, black 24px),
                radial-gradient(circle at 66.75% 25%, transparent 22px, black 24px),
                radial-gradient(circle at 86.5% 32.5%, transparent 22px, black 24px),
                radial-gradient(circle at 12.5% 75%, transparent 22px, black 24px),
                radial-gradient(circle at 30.75% 62.5%, transparent 22px, black 24px),
                radial-gradient(circle at 48.5% 75%, transparent 22px, black 24px),
                radial-gradient(circle at 66.75% 62.5%, transparent 22px, black 24px),
                radial-gradient(circle at 86.5% 75%, transparent 22px, black 24px);
                mask-image: 
                radial-gradient(circle at 12.5% 32.5%, transparent 22px, black 24px),
                /* ... */
                radial-gradient(circle at 30.75% 25%, transparent 22px, black 24px),
                radial-gradient(circle at 48.5% 32.5%, transparent 22px, black 24px),
                radial-gradient(circle at 66.75% 25%, transparent 22px, black 24px),
                radial-gradient(circle at 86.5% 32.5%, transparent 22px, black 24px),
                radial-gradient(circle at 12.5% 75%, transparent 22px, black 24px),
                radial-gradient(circle at 30.75% 62.5%, transparent 22px, black 24px),
                radial-gradient(circle at 48.5% 75%, transparent 22px, black 24px),
                radial-gradient(circle at 66.75% 62.5%, transparent 22px, black 24px),
                radial-gradient(circle at 86.5% 75%, transparent 22px, black 24px);
            }
            .word { font-size: 8rem; }
            .word.long-word { font-size: 5rem; }
            .main-title { font-size: 1.5rem; }
            .card-container { padding: 20px; }
            
            .info-bar { gap: 10px; }
            .slot-machine { font-size: 1rem; min-width: 100px; padding: 0 10px; }
        }
    </style>
 </head>
 <body>

  <!-- ç¬¬ä¸€å±¤ï¼šä¸»é¸å–® -->
  <div id="menuScreen" class="card-container">
      <h1 class="main-title">åº·è»’åœ‹èªå…­ä¸Šèªè©æ´å¯Ÿå…ˆæ©Ÿ</h1>
      <p class="text-gray-600 mb-4 font-bold">è«‹é¸æ“‡è¦è¤‡ç¿’çš„èª²æ¬¡ï¼ˆå¯è¤‡é¸ï¼‰ï¼š</p>
      
      <div class="lesson-grid">
          <div class="lesson-toggle" onclick="toggleLesson(7)" id="lesson-7">
              <div>ç¬¬ä¸ƒèª²</div>
              <div class="lesson-title-small">å¤§å°å‰›å¥½çš„é‹å­</div>
          </div>
          <div class="lesson-toggle" onclick="toggleLesson(8)" id="lesson-8">
              <div>ç¬¬å…«èª²</div>
              <div class="lesson-title-small">ç‹å‡è™å¨</div>
          </div>
          <div class="lesson-toggle" onclick="toggleLesson(9)" id="lesson-9">
              <div>ç¬¬ä¹èª²</div>
              <div class="lesson-title-small">ç©ºåŸè¨ˆ</div>
          </div>
          <div class="lesson-toggle" onclick="toggleLesson(10)" id="lesson-10">
              <div>ç¬¬åèª²</div>
              <div class="lesson-title-small">è€¶èª•ç¯€</div>
          </div>
          <div class="lesson-toggle" onclick="toggleLesson(11)" id="lesson-11">
              <div>ç¬¬åä¸€èª²</div>
              <div class="lesson-title-small">ä¸‹åˆèŒ¶é¢¨æ³¢</div>
          </div>
          <div class="lesson-toggle" onclick="toggleLesson(12)" id="lesson-12">
              <div>ç¬¬åäºŒèª²</div>
              <div class="lesson-title-small">ç¥•å¯†èŠ±åœ’</div>
          </div>
      </div>

      <button class="start-btn" onclick="startGame()" id="startBtn" disabled>é–‹å§‹éŠæˆ²</button>
  </div>

  <!-- ç¬¬äºŒå±¤ï¼šéŠæˆ²ç•«é¢ -->
  <div id="gameScreen" class="card-container hidden-screen">
   <h1 class="main-title" id="gameTitle">èªè©æ´å¯Ÿå…ˆæ©Ÿ</h1>
   
   <div class="info-bar">
       <div class="progress-info">
        ç¬¬ <span id="currentQuestion">1</span> é¡Œ / å…± <span id="totalQuestions">12</span> é¡Œ
       </div>
       <button class="slot-machine" onclick="spinSlot()" id="slotMachineBtn">
           ğŸ² æŠ½è™Ÿç¢¼
       </button>
   </div>
   
   <div class="word-card">
    <div class="word" id="currentWord">èªè©</div>
    
    <div class="cover-card" onclick="revealWord()"></div>
    
    <!-- 10å€‹æ•¸å­—åœˆåœˆ -->
    <div class="number-circle pos-1" onclick="removeCircle(1)">1</div>
    <div class="number-circle pos-2" onclick="removeCircle(2)">2</div>
    <div class="number-circle pos-3" onclick="removeCircle(3)">3</div>
    <div class="number-circle pos-4" onclick="removeCircle(4)">4</div>
    <div class="number-circle pos-5" onclick="removeCircle(5)">5</div>
    <div class="number-circle pos-6" onclick="removeCircle(6)">6</div>
    <div class="number-circle pos-7" onclick="removeCircle(7)">7</div>
    <div class="number-circle pos-8" onclick="removeCircle(8)">8</div>
    <div class="number-circle pos-9" onclick="removeCircle(9)">9</div>
    <div class="number-circle pos-10" onclick="removeCircle(10)">10</div>
   </div>

   <div class="game-controls">
       <button class="btn prev-btn" onclick="previousWord()" id="prevBtn">â¬…ï¸ ä¸Šä¸€é¡Œ</button>
       <button class="btn restart-btn" onclick="restartCurrentWord()">ğŸ”„ æœ¬é¡Œé‡ä¾†</button>
       <button class="btn next-btn" onclick="nextWord()" id="nextBtn">ä¸‹ä¸€é¡Œ â¡ï¸</button>
   </div>
   
   <button class="btn back-menu-btn" onclick="backToMenu()">ğŸ  å›åˆ°ä¸»é¸å–®</button>
  </div>

  <script>
        const lessonData = {
            7: ['ä»°å…‰', 'ç·¬ç”¸', 'è…³è¸', 'å‘¢çµ¨', 'ä¸‹è¥¬', 'æ£æ„', 'æ‰¹åˆ¤', 'è¡Œå¾‘', 'è¬¹è¨˜', 'æ°æ°', 'ä¹äººå•æ´¥', 'æ”¾ä¹‹å››æµ·è€Œçš†æº–', 'å—¤ä¹‹ä»¥é¼»'],
            8: ['ç¸«éš™', 'æ—¨æ„', 'æ‚ é–’', 'å¯“è¨€', 'é·¸èšŒç›¸çˆ­', 'ç‹¡å…”ä¸‰çªŸ', 'ç‹¡çŒ¾', 'æ‹›æ–æ’é¨™', 'å½è£', 'èª‡å¤§', 'åˆ†è¾¨', 'è¬Šè¨€', 'è«·åˆº', 'è­¦æƒ•', 'è§€å¯Ÿ', 'è’™è”½', 'è™›å¼µè²å‹¢'],
            9: ['è¡—äº­', 'èª˜æ•µ', 'å¸é¦¬æ‡¿', 'æ——å¹Ÿ', 'å´—ä½', 'ç™¾å§“', 'å€˜è‹¥', 'æ›¸åƒ®', 'æ’¤é€€', 'è«¸è‘›äº®', 'è¬¹æ…', 'ä¸ç›¸'],
            10: ['è€¶èª•ç¯€', 'éƒŠå¤–', 'æ…ˆç¥¥', 'åŠˆå•ª', 'é›¶ç”¨éŒ¢', 'å­å€¦', 'è¾¯è­·', 'è‡ªç§è‡ªåˆ©', 'è²§çª®', 'é—œä¿‚', 'ç¨å¾®', 'æš–çƒ˜çƒ˜', 'è¡·å¿ƒ', 'é‹¼ç´'],
            11: ['æ¢å¾©', 'æ´»æ½‘', 'è‰è“', 'å®¢å»³', 'å‰é¡', 'çŒé†‰', 'åŸè«’', 'é›™è„£', 'ä¹æ±‚', 'é›ªæ©‡', 'è¿´ç›ª'],
            12: ['è¨ç•°', 'è‡‰é °', 'è“¬å‹ƒ', 'å®¶åº­é†«å¸«', 'åš´è‚…', 'è–”è–‡', 'ç€°æ¼«', 'åŒ…æ‹¬', 'èèŸ»', 'å„˜ç®¡']
        };

        const lessonTitles = {
            7: 'å¤§å°å‰›å¥½çš„é‹å­',
            8: 'ç‹å‡è™å¨',
            9: 'ç©ºåŸè¨ˆ',
            10: 'è€¶èª•ç¯€',
            11: 'ä¸‹åˆèŒ¶é¢¨æ³¢',
            12: 'ç¥•å¯†èŠ±åœ’'
        };
        
        // éŠæˆ²ç‹€æ…‹è®Šæ•¸
        let selectedLessons = new Set();
        let gameWords = [];
        let currentWordIndex = 0;
        let availableSlotNumbers = [];

        // --- æ‹‰éœ¸æ©Ÿé‚è¼¯ ---

        function initSlotNumbers() {
            availableSlotNumbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
            const btn = document.getElementById('slotMachineBtn');
            btn.textContent = 'ğŸ² æŠ½è™Ÿç¢¼';
            btn.disabled = false;
            btn.classList.remove('disabled');
        }

        function spinSlot() {
            const btn = document.getElementById('slotMachineBtn');
            
            if (availableSlotNumbers.length === 0) {
                return;
            }

            // ç¦æ­¢é‡è¤‡é»æ“Š
            btn.disabled = true;
            
            // å‹•ç•«æ•ˆæœ
            let count = 0;
            const maxCount = 10; // è·³å‹•æ¬¡æ•¸
            const interval = setInterval(() => {
                // å¾å‰©é¤˜è™Ÿç¢¼ä¸­éš¨æ©Ÿé¡¯ç¤ºä¸€å€‹åšå‹•ç•«
                const randomIndex = Math.floor(Math.random() * availableSlotNumbers.length);
                btn.textContent = `ğŸ² ${availableSlotNumbers[randomIndex]}`;
                count++;
                
                if (count >= maxCount) {
                    clearInterval(interval);
                    // æœ€çµ‚æ±ºå®š
                    const finalIndex = Math.floor(Math.random() * availableSlotNumbers.length);
                    const number = availableSlotNumbers[finalIndex];
                    
                    // é¡¯ç¤ºçµæœ
                    btn.textContent = `âœ¨ ${number} âœ¨`;
                    
                    // å¾æ± ä¸­ç§»é™¤è©²è™Ÿç¢¼
                    availableSlotNumbers.splice(finalIndex, 1);
                    
                    // é‡æ–°å•Ÿç”¨æŒ‰éˆ•ï¼ˆé™¤éæ²’è™Ÿç¢¼äº†ï¼‰
                    if (availableSlotNumbers.length === 0) {
                        setTimeout(() => {
                            btn.textContent = 'å·²æŠ½å®Œ';
                            btn.classList.add('disabled');
                        }, 1000);
                    } else {
                        btn.disabled = false;
                    }
                }
            }, 50); // è·³å‹•é€Ÿåº¦
        }

        // --- é¸å–®é‚è¼¯ ---
        
        function toggleLesson(lesson) {
            const btn = document.getElementById(`lesson-${lesson}`);
            if (selectedLessons.has(lesson)) {
                selectedLessons.delete(lesson);
                btn.classList.remove('selected');
            } else {
                selectedLessons.add(lesson);
                btn.classList.add('selected');
            }
            
            // æª¢æŸ¥æ˜¯å¦å•Ÿç”¨é–‹å§‹æŒ‰éˆ•
            document.getElementById('startBtn').disabled = selectedLessons.size === 0;
        }

        function startGame() {
            if (selectedLessons.size === 0) return;

            // æ”¶é›†ä¸¦åˆä½µèªè©
            gameWords = [];
            selectedLessons.forEach(lesson => {
                gameWords = gameWords.concat(lessonData[lesson]);
            });

            // éš¨æ©Ÿæ‰“äº‚
            gameWords.sort(() => Math.random() - 0.5);
            currentWordIndex = 0;

            // åˆ‡æ›ç•«é¢
            document.getElementById('menuScreen').classList.add('hidden-screen');
            document.getElementById('gameScreen').classList.remove('hidden-screen');
            
            // æ›´æ–°æ¨™é¡Œ
            const sortedLessons = Array.from(selectedLessons).sort((a,b) => a-b);
            let titleText = "";
            
            if (sortedLessons.length === 6) {
                titleText = "åº·è»’åœ‹èªå…­ä¸Š ç¬¬7-12èª² ç¶œåˆç·´ç¿’"; 
            } else {
                const titles = sortedLessons.map(id => lessonTitles[id]).join('ã€');
                titleText = `ç¬¬${sortedLessons.join('ã€')}èª² (${titles})`;
            }
            
            document.getElementById('gameTitle').textContent = titleText;

            updateDisplay();
            restartCurrentWord();
        }

        function backToMenu() {
            document.getElementById('gameScreen').classList.add('hidden-screen');
            document.getElementById('menuScreen').classList.remove('hidden-screen');
        }

        // --- éŠæˆ²é‚è¼¯ ---

        function updateDisplay() {
            const wordElement = document.getElementById('currentWord');
            const currentWord = gameWords[currentWordIndex];
            
            wordElement.textContent = currentWord;
            
            // å­—é«”å¤§å°æ§åˆ¶
            if (currentWord.length >= 3) {
                wordElement.classList.add('long-word');
            } else {
                wordElement.classList.remove('long-word');
            }
            
            document.getElementById('currentQuestion').textContent = currentWordIndex + 1;
            document.getElementById('totalQuestions').textContent = gameWords.length;
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.getElementById('prevBtn').disabled = currentWordIndex === 0;
            document.getElementById('nextBtn').disabled = currentWordIndex === gameWords.length - 1;
        }

        function revealWord() {
            const coverCard = document.querySelector('.cover-card');
            coverCard.classList.add('hidden');
        }

        function removeCircle(number) {
            const circles = document.querySelectorAll('.number-circle');
            circles[number - 1].classList.add('hidden');
        }

        function restartCurrentWord() {
            const coverCard = document.querySelector('.cover-card');
            const circles = document.querySelectorAll('.number-circle');
            
            coverCard.classList.remove('hidden');
            circles.forEach(circle => {
                circle.classList.remove('hidden');
            });
            
            // é‡ç½®æ‹‰éœ¸æ©Ÿ
            initSlotNumbers();
        }

        function nextWord() {
            if (currentWordIndex < gameWords.length - 1) {
                const wordElement = document.getElementById('currentWord');
                wordElement.style.opacity = '0';
                
                currentWordIndex++;
                
                restartCurrentWord(); // é€™è£¡ä¹Ÿæœƒé‡ç½®æ‹‰éœ¸æ©Ÿ
                updateDisplay(); 
                
                setTimeout(() => {
                    wordElement.style.opacity = '1';
                }, 200);
            }
        }

        function previousWord() {
            if (currentWordIndex > 0) {
                const wordElement = document.getElementById('currentWord');
                wordElement.style.opacity = '0';
                
                currentWordIndex--;
                
                restartCurrentWord(); // é€™è£¡ä¹Ÿæœƒé‡ç½®æ‹‰éœ¸æ©Ÿ
                updateDisplay();
                
                setTimeout(() => {
                    wordElement.style.opacity = '1';
                }, 200);
            }
        }
    </script>
 </body>
</html>